"use strict";(self.webpackChunkpdjr_skplugin_alarm_manager=self.webpackChunkpdjr_skplugin_alarm_manager||[]).push([[739],{469:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var l=a(624),s=a.n(l),n=a(264),i=a(985);function o({type:e,name:t,value:a,label:l,radios:o,text:r,labelWidth:u,wrap:c,options:h,rows:p,labelStyle:b,style:m,onChangeCallback:d}){return s().createElement(n.cw,{row:!0},l?s().createElement(n.JX,{md:u},s().createElement(n.__,{style:b,htmlFor:t},l)):"",s().createElement(n.JX,null,"checkbox"==e?s().createElement(n.II,{type:"checkbox",name:t,onChange:e=>d(e.target.value),checked:a}):"","multiselect"==e?s().createElement(i.ZP,{name:t,options:h,value:a,isMulti:!0,className:"basic-multi-select",classNamePrefix:"select",onChange:e=>d(e)}):"","text"==e?s().createElement(n.II,{type:"text",name:t,value:a,onChange:e=>d(e.target.value)}):"","textarea"==e?s().createElement("textarea",{name:t,value:a,rows:p,wrap:c,style:m,onChange:e=>d(e.target.value)}):"",r?s().createElement(n.R9,{color:"muted"},r):""))}var r=a(893),u=a.n(r);function c({labelWidth:e="3",collapsibleTriggerStyle:t={},collapsiblePanelStyle:a={},collapsibleLabel:l="Default methods",notificationMethods:i=[],methods:r,onChangeCallback:c}){return s().createElement(n.cw,{row:!0},s().createElement(n.JX,null,s().createElement(u(),{trigger:l+"...",collapsibleTriggerStyle:t},s().createElement("div",{style:a},s().createElement(o,{type:"multiselect",name:"alertMethod",label:"Alert",labelWidth:e,value:r.alert.map((e=>({label:e,value:e}))),options:i.map((e=>({label:e,value:e}))),onChangeCallback:e=>c("alert",(e||[]).map((e=>e.value)))}),s().createElement(o,{type:"multiselect",name:"warnMethod",label:"Warn",labelWidth:e,value:r.warn.map((e=>({label:e,value:e}))),options:i.map((e=>({label:e,value:e}))),onChangeCallback:e=>c("warn",(e||[]).map((e=>e.value)))}),s().createElement(o,{type:"multiselect",name:"alarmMethod",label:"Alarm",labelWidth:e,value:r.alarm.map((e=>({label:e,value:e}))),options:i.map((e=>({label:e,value:e}))),onChangeCallback:e=>c("alarm",(e||[]).map((e=>e.value)))}),s().createElement(o,{type:"multiselect",name:"emergencyMethod",label:"Emergency",labelWidth:e,value:r.emergency.map((e=>({label:e,value:e}))),options:i.map((e=>({label:e,value:e}))),onChangeCallback:e=>c("emergency",(e||[]).map((e=>e.value)))})))))}function h({panelStyle:e={},labelWidth:t="3",notificationStates:a=[],output:l,onChangeCallback:i,onDeleteCallback:r}){return s().createElement("div",{style:e},s().createElement(o,{type:"text",label:"Name",labelWidth:t,value:l.name,onChangeCallback:e=>i(l.name,"name",e)}),s().createElement(o,{type:"text",label:"Path",labelWidth:t,value:l.path,onChangeCallback:e=>i(l.name,"path",e)}),s().createElement(o,{type:"multiselect",label:"Triggers",labelWidth:t,value:l.triggerStates.map((e=>({label:e,value:e}))),options:a.map((e=>({label:e,value:e}))),onChangeCallback:e=>i(l.name,"triggerStates",(e||[]).map((e=>e.value)))}),s().createElement(o,{type:"text",label:"Suppression path",labelWidth:t,value:l.suppressionPath,onChangeCallback:e=>i(l.name,"suppressionPath",e)}),s().createElement("div",null,s().createElement(n.zx,{onClick:()=>r(l.name)},"Delete")))}function p({labelWidth:e="3",collapsibleTriggerStyle:t={},collapsiblePanelStyle:a={},collapsibleLabel:l="Outputs",panelStyle:i={},notificationStates:o=[],outputs:r,onChangeCallback:c,onDeleteCallback:p,onCreateCallback:b}){return s().createElement(n.cw,{row:!0},s().createElement(n.JX,null,s().createElement(u(),{trigger:l+"...",triggerStyle:t},s().createElement("div",{style:a},r.map((t=>s().createElement(h,{panelStyle:i,labelWidth:e,output:t,notificationStates:o,onChangeCallback:c,onDeleteCallback:p}))),s().createElement("div",null,s().createElement(n.zx,{onClick:()=>b(),style:{width:"100%"}},"+"))))))}function b({labelWidth:e="3",collapsibleTriggerStyle:t={},collapsiblePanelStyle:a={},collapsibleLabel:l="Push notifications",notificationStates:i=[],pushNotifications:r,onChangeCallback:c}){return s().createElement(n.cw,{row:!0},s().createElement(n.JX,null,s().createElement(u(),{trigger:l+"...",collapsibleTriggerStyle:t},s().createElement("div",{style:a},s().createElement(o,{type:"checkbox",name:"enabled",label:"Send push notifications",labelWidth:e,value:r.enabled,onChangeCallback:e=>c("enabled",e)}),s().createElement(o,{type:"multiselect",name:"triggerStates",label:"Trigger states",labelWidth:e,value:r.triggerStates.map((e=>({label:e,value:e}))),options:i.map((e=>({label:e,value:e}))),onChangeCallback:e=>c("triggerStates",(e||[]).map((e=>e.value)))}),s().createElement(o,{type:"text",name:"resourcesProviderId",label:"Resources provider id",labelWidth:e,value:r.resourcesProviderId,onChangeCallback:e=>c("resourcesProviderId",e)}),s().createElement(o,{type:"text",name:"resourceType",label:"Resources type",labelWidth:e,value:r.resourceType,onChangeCallback:e=>c("resourceType",e)})))))}const m={},d={background:"#f0f0f0",padding:"4px",marginTop:"3px"},g={background:"#e0e0e0",padding:"4px",marginBottom:"3px"},f=["visual","sound"],v=["alert","warn","alarm","emergency"],C="3";class E extends s().Component{constructor(e){super(e),this.state={saveButtonDisabled:!0,cancelButtonDisabled:!0,subscribeButtonDisabled:!0,unsubscribeButtonDisabled:!0,ignorePaths:e.configuration.ignorePaths,digestPath:e.configuration.digestPath,outputs:e.configuration.outputs,pushNotifications:e.configuration.pushNotifications,defaultMethods:e.configuration.defaultMethods},this.options=_.cloneDeep(this.props.configuration),this.setIgnorePaths=this.setIgnorePaths.bind(this),this.setDigestPath=this.setDigestPath.bind(this),this.updateOutput=this.updateOutput.bind(this),this.deleteOutput=this.deleteOutput.bind(this),this.createOutput=this.createOutput.bind(this),this.setDefaultMethods=this.setDefaultMethods.bind(this),this.setPushNotifications=this.setPushNotifications.bind(this)}setIgnorePaths(e){this.setState({ignorePaths:e.split(",").map((e=>e.trim())).sort(),saveButtonDisabled:!1,cancelButtonDisabled:!1})}setDigestPath(e){this.setState({digestPath:e.trim(),saveButtonDisabled:!1,cancelButtonDisabled:!1})}updateOutput(e,t,a){var l=[];this.state.outputs.forEach((s=>{if(s.name===e)switch(t){case"name":l.push({name:a,path:s.path,triggerStates:s.triggerStates,suppressionPath:s.suppressionPath});break;case"path":l.push({name:s.name,path:a,triggerStates:s.triggerStates,suppressionPath:s.suppressionPath});break;case"triggerStates":l.push({name:s.name,path:s.path,triggerStates:a,suppressionPath:s.suppressionPath});break;case"suppressionPath":l.push({name:s.name,path:s.path,triggerStates:s.triggerStates,suppressionPath:a})}else l.push(s)})),this.setState({outputs:l,saveButtonDisabled:!1,cancelButtonDisabled:!1})}deleteOutput(e){var t=[];this.state.outputs.forEach((a=>{a.name!==e&&t.push(a)})),this.setState({outputs:t,saveButtonDisabled:!1,cancelButtonDisabled:!1})}createOutput(){for(var e=_.cloneDeep(this.state.outputs),t=["new-output1","new-output2","new-output3","new-output4"],a=0;a<t.length;a++)if(!e.map((e=>e.name)).includes(t[a])){e.push({name:t[a],path:"notifications.plugins.alarm-manager."+t[a],triggerStates:[],suppressionPath:""});break}this.setState({outputs:e,saveButtonDisabled:!1,cancelButtonDisabled:!1})}setDefaultMethods(e,t){var a={};Object.keys(this.state.defaultMethods).forEach((l=>{a[l]=l===e?t:this.state.defaultMethods[l]})),this.setState({defaultMethods:a,saveButtonDisabled:!1,cancelButtonDisabled:!1})}setPushNotifications(e,t){var a={};Object.keys(this.state.pushNotifications).forEach((l=>{a[l]=l===e?t:this.state.pushNotifications[l]})),this.setState({pushNotifications:a,saveButtonDisabled:!1,cancelButtonDisabled:!1})}render(){return s().createElement(n.l0,{className:"square rounded border",style:{padding:"5px"}},s().createElement(n.cw,{row:!0},s().createElement(n.JX,null,s().createElement(o,{type:"textarea",name:"ignorePaths",label:"Ignore paths",labelWidth:C,value:this.state.ignorePaths.join(", "),rows:"2",wrap:"on",style:{width:"100%"},onChangeCallback:this.setIgnorePaths}),s().createElement(o,{type:"text",name:"digestPath",label:"Digest path",labelWidth:C,value:this.state.digestPath,text:"",onChangeCallback:this.setDigestPath}),s().createElement(p,{labelWidth:C,collapsibleTriggerStyle:m,collapsiblePanelStyle:d,collapsibleLabel:"Outputs",panelStyle:g,notificationStates:v,outputs:this.state.outputs,onChangeCallback:this.updateOutput,onDeleteCallback:this.deleteOutput,onCreateCallback:this.createOutput}),s().createElement(b,{labelWidth:C,collapsibleTriggerStyle:m,collapsiblePanelStyle:d,collapsibleLabel:"Push notifications",notificationStates:v,pushNotifications:this.state.pushNotifications,onChangeCallback:this.setPushNotifications}),s().createElement(c,{labelWidth:C,collapsibleLabel:"Default methods",collapsibleTriggerStyle:m,collapsiblePanelStyle:d,notificationMethods:f,methods:this.state.defaultMethods,onChangeCallback:this.setDefaultMethods}))),s().createElement(n.cw,{row:!0},s().createElement(n.JX,null,s().createElement(n.Si,{style:{justifyContent:"space-between"}},s().createElement(n.Si,null,s().createElement(n.zx,{size:"sm",color:"primary",disabled:this.state.saveButtonDisabled,onClick:e=>{e.preventDefault(),this.onSubmit()}},s().createElement("i",{className:"fa fa-save"})," Save ")," ",s().createElement(n.zx,{size:"sm",color:"primary",disabled:this.state.cancelButtonDisabled,onClick:e=>{e.preventDefault(),this.onCancel()}},s().createElement("i",{className:"fa fa-ban"})," Cancel ")),s().createElement(n.Si,null,s().createElement(n.zx,{size:"sm",color:"primary",disabled:this.state.unsubscribeButtonDisabled,onClick:e=>{e.preventDefault(),this.onUnsubscribe()}},s().createElement("i",{className:"fa fa-save"})," Unsubscribe ")," ",s().createElement(n.zx,{size:"sm",color:"primary",disabled:this.state.subscribeButtonDisabled,onClick:e=>{e.preventDefault(),this.onSubscribe()}},s().createElement("i",{className:"fa fa-ban"})," Subscribe "))))))}onSubmit(){this.setState({saveButtonDisabled:!0,cancelButtonDisabled:!0}),this.save({ignorePaths:this.state.ignorePaths.split(",").map((e=>e.trim())),digestPath:this.state.digestPath,outputs:this.stateOutputs,defaultMethods:this.state.defaultMethods})}onCancel(){this.setState({saveButtonDisabled:!0,cancelButtonDisabled:!0}),this.setState({ignorePaths:this.props.configuration.ignorePaths.join(", ")}),this.setState({digestPath:this.props.configuration.digestPath}),this.setState({outputs:this.props.configuration.outputs}),this.setState({defaultMethods:this.props.configuration.defaultMethods})}onSubscribe(){this.setState({subscribeButtonDisabled:!0})}onUnsubscribe(){this.setState({unsubscribeButtonDisabled:!0})}}const S=E,y=e=>s().createElement(n.Zb,null,s().createElement(n.Ol,null,"Alarm Manager Configuration"),s().createElement(n.eW,null,s().createElement("div",null,s().createElement("div",{style:{width:"100%"}},s().createElement(S,{configuration:e.configuration,save:t=>e.save(t)})))))}}]);